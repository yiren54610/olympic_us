aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 25 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
# Other Sport -- Only female
other<-ggplot(data = subset(df_long,!dominant&df_long$gender=="female")) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, !dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 25 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
# Other Sport -- Only female
other<-ggplot(data = subset(df_long,!dominant&df_long$gender=="female")) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, !dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
color = 'darkgray',
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 25 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
#bar
main
historical <- read_csv("Female_pct_historical.csv")
Total_bar <- ggplot(historical) +
aes(x = as.Date(paste0(year, "-01-01")),y=female_pct,fill = color)+
geom_col() +
geom_hline(yintercept = 50,
linetype = "dotted",
color = "blue",
size = 0.5) +
geom_text(x=as.Date("2000-01-01"),
y=53,
label="50% of medals",
color = "blue") +
labs(
title = "Females have been winning over 50% since 2008.",
subtitle = "Percentage of medals won by female athletes since 1984")+
scale_x_date(
breaks = as.Date(c("2008-01-01", "2024-01-01")),  # Set breaks only for 2008 and 2024
labels = c("2008", "2024")  # Set the corresponding labels
)  +
geom_rect(data = historical,
aes(
xmin = as.Date("2006-01-01"),xmax=as.Date("2026-01-01"),
ymin = 0, ymax = 60,
fill = "lightcoral"),
alpha = 0.01,
inherit.aes = FALSE) +
theme_minimal() +
scale_fill_identity() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
Total_bar
historical$color <- ifelse(historical$year == 2024, "lightcoral", "grey")
Total_bar <- ggplot(historical) +
aes(x = as.Date(paste0(year, "-01-01")),y=female_pct,fill = color)+
geom_col() +
geom_hline(yintercept = 50,
linetype = "dotted",
color = "blue",
size = 0.5) +
geom_text(x=as.Date("2000-01-01"),
y=53,
label="50% of medals",
color = "blue") +
labs(
title = "Females have been winning over 50% since 2008.",
subtitle = "Percentage of medals won by female athletes since 1984")+
scale_x_date(
breaks = as.Date(c("2008-01-01", "2024-01-01")),  # Set breaks only for 2008 and 2024
labels = c("2008", "2024")  # Set the corresponding labels
)  +
geom_rect(data = historical,
aes(
xmin = as.Date("2006-01-01"),xmax=as.Date("2026-01-01"),
ymin = 0, ymax = 60,
fill = "lightcoral"),
alpha = 0.01,
inherit.aes = FALSE) +
theme_minimal() +
scale_fill_identity() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
Total_bar
Total_bar <- ggplot(historical) +
aes(x = as.Date(paste0(year, "-01-01")),y=female_pct,fill = color)+
geom_col() +
geom_hline(yintercept = 50,
linetype = "dotted",
color = "blue",
size = 0.5) +
geom_text(x=as.Date("2000-01-01"),
y=53,
label="50% of medals",
color = "darkblue") +
labs(
title = "Females have been winning over 50% since 2008.",
subtitle = "Percentage of medals won by female athletes since 1984")+
scale_x_date(
breaks = as.Date(c("2008-01-01", "2024-01-01")),  # Set breaks only for 2008 and 2024
labels = c("2008", "2024")  # Set the corresponding labels
)  +
geom_rect(data = historical,
aes(
xmin = as.Date("2006-01-01"),xmax=as.Date("2026-01-01"),
ymin = 0, ymax = 60,
fill = "lightcoral"),
alpha = 0.01,
inherit.aes = FALSE) +
theme_minimal() +
scale_fill_identity() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
Total_bar
Display
main
other
Total_bar <- ggplot(historical) +
aes(x = as.Date(paste0(year, "-01-01")),y=female_pct,fill = color)+
geom_col() +
geom_hline(yintercept = 50,
linetype = "dotted",
color = "blue",
size = 0.5) +
geom_text(x=as.Date("2000-01-01"),
y=53,
label="50% of medals",
color = "darkblue") +
labs(
title = "Females have been winning over 50% since 2008.",
subtitle = "Percentage of medals won by female athletes since 1984")+
scale_x_date(
breaks = as.Date(c("2008-01-01", "2024-01-01")),  # Set breaks only for 2008 and 2024
labels = c("2008", "2024")  # Set the corresponding labels
)  +
geom_rect(data = historical,
aes(
xmin = as.Date("2006-01-01"),xmax=as.Date("2026-01-01"),
ymin = 0, ymax = 60,
fill = "yellow"),
alpha = 0.01,
inherit.aes = FALSE) +
theme_minimal() +
scale_fill_identity() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
Total_bar
Total_bar <- ggplot(historical) +
aes(x = as.Date(paste0(year, "-01-01")),y=female_pct,fill = color)+
geom_col() +
geom_hline(yintercept = 50,
linetype = "dotted",
color = "lightcoral",
size = 0.5) +
geom_text(x=as.Date("2000-01-01"),
y=53,
label="50% of medals",
color = "coral") +
labs(
title = "Females have been winning over 50% since 2008.",
subtitle = "Percentage of medals won by female athletes since 1984")+
scale_x_date(
breaks = as.Date(c("2008-01-01", "2024-01-01")),  # Set breaks only for 2008 and 2024
labels = c("2008", "2024")  # Set the corresponding labels
)  +
geom_rect(data = historical,
aes(
xmin = as.Date("2006-01-01"),xmax=as.Date("2026-01-01"),
ymin = 0, ymax = 60,
fill = "yellow"),
alpha = 0.01,
inherit.aes = FALSE) +
theme_minimal() +
scale_fill_identity() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
Total_bar
Display
main
other
main
# Only for dominant sport
main <- ggplot(data = subset(df_long,dominant)) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "darkgrey", stroke = 1, shape = 21) +
#highlight over 50%
geom_point(data = subset(df_long, df_long$Sport %in% c("Swimming", "Gymnastics")&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 2, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=53,y=1.1),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
# Labels for specific points
geom_text_repel(data = subset(df_long, dominant),
aes(label = Sport, color = "darkgrey"),
vjust = -5, size = 3,
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE) +
scale_size_continuous(range = c(5,20)) +
labs(color = "Gender",
x = 'Percetage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Swimmers and Gymnnasts Contribute to More Than 50%",
subtitle = "Female swimmers and gymnasts also have the highest no. of medals per person") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
main
Total_bar
Display
main
other
Total_bar
Display
main
other
Total_bar
Display
Total_bar
Display
main
main
other
# Other Sport -- Only female
other<-ggplot(data = subset(df_long,!dominant&df_long$gender=="female")) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, !dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
color = 'darkgray',
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 26 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
# Other Sport -- Only female
other<-ggplot(data = subset(df_long,!dominant&df_long$gender=="female")) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, !dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
color = 'darkgray',
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 27 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
# Other Sport -- Only female
other<-ggplot(data = subset(df_long,!dominant&df_long$gender=="female")) +
aes(x = pct, y = average, color = gender, size = owned) +
geom_point(alpha = .9) +
# Points with black outlines
geom_point(data = subset(df_long, !dominant),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
stroke = 1, shape = 21) +
scale_size_continuous(range = c(5,20)) +
# label sports
geom_text_repel(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(label = Sport),
vjust = -2, size = 3,hjust = 1.5,
color = 'darkgray',
segment.color = "grey",
segment.linetype = "dotted",
show.legend = FALSE,
color = "gray") +
#highlight over 50%
geom_point(data = subset(df_long, !dominant&df_long$gender=="female"&df_long$pct > 50),
aes(x = pct, y = average, size = owned, alpha = .7),
show.legend = FALSE,
color = "yellow", stroke = 1.5, shape = 21) +
# add the 50% line
geom_vline(xintercept = 50,
linetype = "dotted",
color = "coral",
alpha = .7 ) +
# add labels of the 50% line
geom_text(data = df_long, aes(x=55,y=1.15),
label = "50% of the medals",
color = "coral",
alpha = .7,
size = 3,
hjust = 0.7) +
labs(color = "Gender",
x = 'Percentage of medals by sport',
y = 'Medals per anthlete by sport',
title = "Female Athletes Won over 50% in Other 11 Sports",
subtitle = "Among other 26 sports, females won over 50% of the medals in 11 of them and half in 3") +
xlim(0,100) +
ylim(0,1.25) +
theme_minimal() +
theme(plot.title.position = 'plot',legend.position = c(0.1,0.9)) +
#set colors
scale_color_manual(values = c("male" = "lightblue", "female" = "lightcoral")) +
guides(size = "none", alpha = "none")
other
ggsave(Total_bar,"Historical_trend.png")
ggsave("Historical_trend.png",Total_bar)
ggsave("team.png",Display)
ggsave("dominant.png",main)
ggsave("niche.png",other)
